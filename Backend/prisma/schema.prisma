generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Playlist {
  id        Int              @id @default(autoincrement())
  name      String
  trivia    PlaylistTrivia[]
  createdAt DateTime         @default(now())
  AppUser   AppUser?         @relation(fields: [appUserId], references: [id])
  appUserId String?
}

enum Category {
  GAMES
  ANIME
  TV_SHOW
  MOVIES
  BOOKS
}

model AppUser {
  id          String   @id @default(uuid()) // Your app's user ID
  supabaseId  String   @unique // Links to auth.users.id
  displayName String
  bio         String?
  level       Int      @default(1)
  createdAt   DateTime @default(now())

  // Relations
  trivia    Trivia[]
  playlists Playlist[]
}

model Trivia {
  id     Int     @id @default(autoincrement())
  userId String
  user   AppUser @relation(fields: [userId], references: [id])

  category           Category
  title              String
  incorrectStatement String
  highlightStart     Int
  highlightEnd       Int
  correction         String
  tags               String[]
  comment            String?
  createdAt          DateTime         @default(now())
  PlaylistTrivia     PlaylistTrivia[]
}

model PlaylistTrivia {
  playlist   Playlist @relation(fields: [playlistId], references: [id])
  playlistId Int

  trivia   Trivia @relation(fields: [triviaId], references: [id])
  triviaId Int

  @@id([playlistId, triviaId]) // Composite primary key
}

model DiscoverCategory {
  id     Int     @id @default(autoincrement())
  name String @unique
}
